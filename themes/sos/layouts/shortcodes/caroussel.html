{{ $interval := .Get "interval" | default 5000 }}

<div class="carousel">
    <div class="carousel-inner">
        {{ $images := findRE "<img[^>]*>" .Inner }}
        {{ range $index, $image := $images }}

        <div class="carousel-item{{ if eq $index 0 }} active{{ end }}">
            {{ $image | safeHTML }}
        </div>
        {{ end }}
    </div>

    <a class="carousel-control prev"> 
        <div>
            {{ readFile "assets/icons/chevron_left.svg"| safeHTML }}
        </div> 
    </a>
    <a class="carousel-control next">
        <div>
            {{ readFile "assets/icons/chevron_right.svg"| safeHTML }}
        </div> 
     </a>
</div>
<div class="carousel-indicators"></div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const carousel = document.querySelector('.carousel');
        const items = document.querySelectorAll('.carousel-item');
        let index = 0;

        // Create carousel indicators dynamically
        const indicatorsContainer = document.querySelector('.carousel-indicators');
        items.forEach((item, i) => {
            const indicator = document.createElement('span');
            indicator.classList.add('indicator');
            indicator.addEventListener('click', function () {
                index = i;
                updateCarousel();
            });
            indicatorsContainer.appendChild(indicator);
            if (i === 0) {
                indicator.classList.add('indicator-active');
            }
        });

        document.querySelector('.next').addEventListener('click', function () {
            index = (index + 1) % items.length;
            updateCarousel();
        });

        document.querySelector('.prev').addEventListener('click', function () {
            index = (index - 1 + items.length) % items.length;
            updateCarousel();
        });

        function updateCarousel() {
            items.forEach((item, i) => {
                item.classList.toggle('active', i === index);
            });

            // Update indicators
            const indicators = document.querySelectorAll('.indicator');
            indicators.forEach((indicator, i) => {
                indicator.classList.toggle('indicator-active', i === index);
            });
        }

        setInterval(function () {
            index = (index + 1) % items.length;
            updateCarousel();
        }, {{ $interval }});
    });
</script>

<style>
    .carousel {
        position: relative;
        overflow: hidden;
        width: 100%;
    }
    .carrousel-inner {
        display: flex;
        height: 500px;
        transition: transform 0.3s ease;
    }

    .carousel-item {
        position:relative;
        display: none;
        height: 500px;
        width: 100%;
        box-sizing: border-box;
    }
    .carousel-item img {
        position:absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }
    .active {
        display: block;
    }

    .carousel img {
        width: 100%;
        height: auto;
    }

    .carousel-control {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 50%;
        font-size: 1.5em;
        width: 40px;
        height: 40px;
        color: black;
        background-color: rgba(255, 255, 255, 0.5);
        text-decoration: none;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }
    .carousel-control div {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .carousel-control:hover {
        background-color: rgba(255, 255, 255, 0.8);
    }
    .carousel-control:hover div svg {
        fill: var(--primary-color)
    }
    .carousel-indicators {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        padding: 1rem 2rem;
        gap: 10px;
    }

    .indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background-color: rgba(0, 0, 0, 0.5);
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .indicator-active {
        background-color: var(--primary-color);
    }
    .prev {
        left: 10px;
        user-select: none;
    }

    .next {
        right: 10px;
        user-select: none;
    }
</style>